class Sprite
Private
    LPDIRECTDRAWSURFACE7 lpDDSpriteSurface := NULL
Public
    function LoadBitmap(LPCWSTR filename)
        
        HBITMAP hBitmap
        BITMAP bitmap;
        HRESULT result

        hBitmap := LoadImage(NULL, filename, IMAGE_BITMAP, 0, 0, LR_LOADFROMFILE)
        if(NULL = hBitmap)
            // error
        end if

       try
            return Video.CreateSurface(hBitmap)
       catch
            throw
       finally
            DeleteObject(hBitmap)
       end try-catch

    end function
end class