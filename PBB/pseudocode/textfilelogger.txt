class TextFileLogger inherits ILog
Private
    StreamWriter sw := NULL

Public
    constructor ApplicationLog(string path)
    
        try
            sw := new StreamWriter(filename, true)
            sw->AutoFlush := true
        catch
            throw
        end try-catch

    end constructor

    function Close()

        if(sw != NULL)
            sw->Close()
            sw := NULL
        end if

    end function

    function Write(string message) : virtual
    
        try
            string timeStamp := DateTime::Now.ToString("dd/MM/yy HH:mm:ss");
            sw->Write("[{0}] {1}" timeStamp, message)
        catch
            throw
        end try

    end function

    function WriteLine(string message) : virtual

        try
            sw->WriteLine(message)
        catch
            throw
        end try

    end function

    destructor ApplicationLog()
    
        Close()

    end destructor

    finalizer ApplicationLog()
    
        Close()

    end finalizer
end class