class MessageBoxLogger inherits ILog
Private
    HWND hWnd
Public
    constructor MessageBoxLogger(HWND hWnd)
        this->hWnd := hWnd
    end constructor

    function Write(string message)

        pin_ptr<wchar_t> unmanagedMessage := PtrToStringChars(message)

        -- may need to call IDirectDraw7::FlipToGDISurface() in order for this to display properly.
        MessageBox(hWnd, unmanagedMessage, "Unholy Error", MB_OK | MB_ICONEXCLAMATION)

    end function

    function WriteLine(string message)
        Write(message + Environment::NewLine)
    end function
end class